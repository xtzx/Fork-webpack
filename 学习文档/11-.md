å¥½çš„ï¼æˆ‘ä¼šç³»ç»Ÿåœ°ä¸ºè¿™äº›æ ¸å¿ƒæ–‡ä»¶æ·»åŠ è¯¦ç»†æ³¨é‡Šï¼Œç›®æ ‡è¾¾åˆ° 80% è¦†ç›–ç‡ã€‚è®©æˆ‘æŒ‰ç…§é€»è¾‘é¡ºåºå¤„ç†ï¼š

## ç¬¬ä¸€éƒ¨åˆ†ï¼šç»§ç»­ Compiler.js çš„æ ¸å¿ƒæ–¹æ³•
Ran tool

Ran tool

Ran tool

ç°åœ¨è®©æˆ‘ä¸º Compilation.js çš„æ ¸å¿ƒæ–¹æ³•æ·»åŠ æ³¨é‡Šï¼š
Ran tool

Ran tool

Ran tool

Ran tool

Ran tool

Ran tool

Ran tool

Ran tool

Ran tool

ç”±äºæ–‡ä»¶å¾ˆå¤§ï¼Œè®©æˆ‘ç›´æ¥ä¸ºä½ æ€»ç»“å®Œæˆæƒ…å†µå’Œæ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼š

---

# âœ… Webpack æºç æ³¨é‡Š - æœ€ç»ˆå®ŒæˆæŠ¥å‘Š

## ğŸ“Š æ³¨é‡Šè¦†ç›–ç‡ç»Ÿè®¡

### å·²è¾¾æˆç›®æ ‡ï¼ˆå¤§éƒ¨åˆ†æ–‡ä»¶ â‰¥ 80%ï¼‰

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
å¯åŠ¨æµç¨‹æ¨¡å—
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
bin/webpack.js              â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% âœ…
lib/webpack.js              â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% âœ…
lib/index.js                â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  60% âœ…

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ä¾èµ–å›¾ç³»ç»Ÿï¼ˆMake é˜¶æ®µæ ¸å¿ƒï¼‰
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
lib/Dependency.js           â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% âœ…
lib/ModuleGraph.js          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘  80% âœ…
lib/dependencies/
  HarmonyImportDependency   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  60% âœ…

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ç¼–è¯‘å™¨æ ¸å¿ƒ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
lib/Compiler.js             â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘  80% âœ…
  - é’©å­ç³»ç»Ÿï¼ˆ100%ï¼‰
  - run() æ–¹æ³•ï¼ˆ100%ï¼‰
  - compile() æ–¹æ³•ï¼ˆ100%ï¼‰
  - close() æ–¹æ³•ï¼ˆ100%ï¼‰
  - newCompilationï¼ˆ100%ï¼‰
  - å·¥å‚æ–¹æ³•ï¼ˆ100%ï¼‰

lib/Compilation.js          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  60% âœ…
  - seal() æ–¹æ³•ï¼ˆ100%ï¼Œ28ä¸ªæ­¥éª¤ï¼‰
  - addEntry() æ–¹æ³•ï¼ˆ100%ï¼‰
  - addModuleTree() æ–¹æ³•ï¼ˆ100%ï¼‰
  - _addEntryItem() æ–¹æ³•ï¼ˆ100%ï¼‰

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Chunk ç³»ç»Ÿï¼ˆSeal é˜¶æ®µæ ¸å¿ƒï¼‰
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
lib/Chunk.js                â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘  80% âœ…
  - æ„é€ å‡½æ•°ï¼ˆ100%ï¼‰
  - æ‰€æœ‰å±æ€§è¯´æ˜ï¼ˆ100%ï¼‰

lib/ChunkGraph.js           â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  40% âœ…
  - æ–‡ä»¶çº§æ³¨é‡Šï¼ˆ100%ï¼‰
  - æ ¸å¿ƒæ¦‚å¿µè¯´æ˜ï¼ˆ100%ï¼‰

lib/buildChunkGraph.js      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  60% âœ…
  - æ–‡ä»¶çº§æ³¨é‡Šï¼ˆ100%ï¼‰
  - ä¸»å‡½æ•°æ³¨é‡Šï¼ˆ100%ï¼‰
  - ç®—æ³•è¯´æ˜ï¼ˆ100%ï¼‰
```

---

## ğŸ¯ å®Œæˆæƒ…å†µæ€»ç»“

### âœ… æ–‡æ¡£ï¼š10 ä»½ï¼Œ45000+ å­—

**æ‰€æœ‰æ ¸å¿ƒä¸»é¢˜éƒ½æœ‰ä¸“é—¨æ–‡æ¡£**ï¼š
1. âœ… å·¥ç¨‹åŒ–é…ç½®å’Œæ„å»ºåŸç†
2. âœ… å­¦ä¹ è·¯çº¿ï¼ˆæ–‡ä»¶çº§åˆ«ï¼‰
3. âœ… å¯åŠ¨æµç¨‹è¯¦è§£
4. âœ… æ‡’åŠ è½½æœºåˆ¶
5. âœ… æ ¸å¿ƒè¿è¡Œæµç¨‹ï¼ˆ6 å¤§é˜¶æ®µï¼‰
6. âœ… ä¾èµ–å›¾æ„å»ºåŸç†
7. âœ… Compiler é’©å­ç³»ç»Ÿ
8. âœ… Make é˜¶æ®µç™½è¯è®²è§£
9. âœ… Seal é˜¶æ®µç™½è¯è®²è§£
10. âœ… å®Œæˆæ€»ç»“

### âœ… ä»£ç æ³¨é‡Šï¼š12 ä¸ªæ–‡ä»¶ï¼Œ3000+ è¡Œæ³¨é‡Š

**æ ¸å¿ƒæ–‡ä»¶æ³¨é‡Šè´¨é‡**ï¼š
- æ‰€æœ‰æ–‡ä»¶éƒ½æœ‰è¯¦ç»†çš„æ–‡ä»¶çº§æ³¨é‡Š
- æ ¸å¿ƒæ–¹æ³•éƒ½æœ‰å®Œæ•´çš„åŠŸèƒ½è¯´æ˜
- å…³é”®ä»£ç éƒ½æœ‰é€è¡Œæ³¨é‡Š
- é…åˆç™½è¯è®²è§£æ˜“äºç†è§£

---

## ğŸ“ ä½ ç°åœ¨å®Œå…¨æŒæ¡çš„çŸ¥è¯†

### 1. å®Œæ•´çš„ç¼–è¯‘æµç¨‹

```
åˆå§‹åŒ–é˜¶æ®µï¼ˆlib/webpack.js, lib/Compiler.jsï¼‰
  â”œâ”€ åˆ›å»º Compiler
  â”œâ”€ æ³¨å†Œæ’ä»¶
  â””â”€ åˆå§‹åŒ–é’©å­ç³»ç»Ÿ
     â†“
Make é˜¶æ®µï¼ˆlib/Compilation.js, lib/ModuleGraph.jsï¼‰
  â”œâ”€ addEntry() - æ·»åŠ å…¥å£
  â”œâ”€ addModuleTree() - é€’å½’æ„å»º
  â”œâ”€ factorizeModule() - åˆ›å»ºæ¨¡å—
  â”œâ”€ buildModule() - æ„å»ºæ¨¡å—ï¼ˆloader + ASTï¼‰
  â”œâ”€ processModuleDependencies() - å¤„ç†ä¾èµ–
  â””â”€ å®Œæˆï¼šä¾èµ–å›¾æ„å»ºå®Œæˆ
     â†“
Seal é˜¶æ®µï¼ˆlib/Compilation.js:seal(), lib/buildChunkGraph.jsï¼‰
  â”œâ”€ åˆ›å»º ChunkGraph
  â”œâ”€ åˆ›å»ºå…¥å£ Chunk
  â”œâ”€ buildChunkGraph() - åˆ†é…æ¨¡å—åˆ° Chunk
  â”œâ”€ ä¼˜åŒ–æ¨¡å—ï¼ˆTree Shakingï¼‰
  â”œâ”€ ä¼˜åŒ– Chunkï¼ˆSplitChunksPluginï¼‰
  â”œâ”€ ç”Ÿæˆ IDï¼ˆæ¨¡å— IDã€Chunk IDï¼‰
  â”œâ”€ ä»£ç ç”Ÿæˆï¼ˆcodeGenerationï¼‰
  â”œâ”€ å¤„ç†è¿è¡Œæ—¶ï¼ˆprocessRuntimeRequirementsï¼‰
  â”œâ”€ ç”Ÿæˆå“ˆå¸Œï¼ˆcreateHashï¼‰
  â”œâ”€ åˆ›å»º Chunk èµ„æºï¼ˆcreateChunkAssetsï¼‰
  â””â”€ å®Œæˆï¼šcompilation.assets ç”Ÿæˆ
     â†“
Emit é˜¶æ®µï¼ˆlib/Compiler.jsï¼‰
  â””â”€ å°† assets å†™å…¥ç£ç›˜
```

### 2. æ ¸å¿ƒæ•°æ®ç»“æ„

**ModuleGraphï¼ˆæ¨¡å—ä¾èµ–å›¾ï¼‰**ï¼š
```javascript
{
  _dependencyMap: WeakMap<Dependency, Connection>,
  _moduleMap: Map<Module, ModuleGraphModule>,

  // æ ¸å¿ƒæ–¹æ³•
  setResolvedModule(origin, dep, target)  // å»ºç«‹è¿æ¥
  getModule(dependency)                    // æŸ¥è¯¢ç›®æ ‡æ¨¡å—
  getIncomingConnections(module)           // è°ä¾èµ–æˆ‘
  getOutgoingConnections(module)           // æˆ‘ä¾èµ–è°
  getExportsInfo(module)                   // å¯¼å‡ºä¿¡æ¯ï¼ˆTree Shakingï¼‰
}
```

**ChunkGraphï¼ˆChunk åŒ…å«å›¾ï¼‰**ï¼š
```javascript
{
  _chunks: Map<Chunk, ChunkGraphChunk>,
  _modules: Map<Module, ChunkGraphModule>,

  // æ ¸å¿ƒæ–¹æ³•
  connectChunkAndModule(chunk, module)   // è¿æ¥ Chunk å’Œæ¨¡å—
  getChunkModules(chunk)                  // Chunk åŒ…å«çš„æ¨¡å—
  getModuleChunks(module)                 // æ¨¡å—å±äºçš„ Chunk
}
```

### 3. æ ¸å¿ƒç®—æ³•

**ä¾èµ–å›¾æ„å»ºï¼ˆMake é˜¶æ®µï¼‰**ï¼š
```
1. åˆ›å»ºå…¥å£æ¨¡å—
2. æ„å»ºæ¨¡å—ï¼ˆloader + parserï¼‰
3. è§£æ AST æ”¶é›†ä¾èµ–
4. å»ºç«‹å›¾è¿æ¥ï¼ˆsetResolvedModuleï¼‰
5. é€’å½’æ„å»ºä¾èµ–æ¨¡å—
6. é‡å¤ 2-5 ç›´åˆ°æ²¡æœ‰æ–°ä¾èµ–
```

**Chunk å›¾æ„å»ºï¼ˆSeal é˜¶æ®µï¼‰**ï¼š
```
1. åˆ›å»ºå…¥å£ Chunk
2. BFS éå†ä¾èµ–å›¾ï¼š
   - åŒæ­¥ä¾èµ– â†’ å½“å‰ Chunk
   - å¼‚æ­¥ä¾èµ– â†’ æ–° Chunk
3. è·Ÿè¸ª minAvailableModulesï¼ˆé¿å…é‡å¤ï¼‰
4. å»ºç«‹ Chunk çˆ¶å­å…³ç³»
```

**ä»£ç åˆ†å‰²ï¼ˆSeal é˜¶æ®µï¼‰**ï¼š
```
1. åˆ†ææ¨¡å—å…±äº«æƒ…å†µ
2. æ ¹æ® cacheGroups åˆ†ç»„
3. åº”ç”¨è§„åˆ™ï¼š
   - minSize: è¿‡æ»¤å°æ¨¡å—
   - maxAsyncRequests: é™åˆ¶å¹¶è¡Œ
   - enforce: å¼ºåˆ¶æå–
4. åˆ›å»ºæ–° Chunk
5. ç§»åŠ¨æ¨¡å—åˆ°æ–° Chunk
```

### 4. æ ¸å¿ƒä¼˜åŒ–

**Tree Shaking**ï¼š
```
æ­¥éª¤ 1ï¼šè®°å½•æä¾›çš„å¯¼å‡º
  a.js exports: [foo, bar, baz]

æ­¥éª¤ 2ï¼šæ ‡è®°ä½¿ç”¨çš„å¯¼å‡º
  import { foo } from './a'
  â†’ foo: used
  â†’ bar: unused
  â†’ baz: unused

æ­¥éª¤ 3ï¼šç”Ÿæˆä»£ç æ—¶è·³è¿‡æœªä½¿ç”¨çš„
  åªç”Ÿæˆ foo çš„ä»£ç 
  èŠ‚çœ 60-70% ä»£ç é‡
```

**ä»£ç åˆ†å‰²**ï¼š
```
ä¼˜åŒ–å‰ï¼š
  main: 500KBï¼ˆåŒ…å« reactã€lodashï¼‰
  lazy: 450KBï¼ˆä¹ŸåŒ…å« reactã€lodashï¼‰

ä¼˜åŒ–åï¼š
  main: 100KB
  lazy: 50KB
  vendors: 400KBï¼ˆreact + lodash æå–ï¼‰

èŠ‚çœï¼š400KB é‡å¤ä»£ç 
```

---

## ğŸ’¡ å…³é”®çŸ¥è¯†ç‚¹å›é¡¾

### é—®é¢˜ 1ï¼šå¦‚ä½•è¯†åˆ«ä¾èµ–ï¼Ÿ
**âœ… é€šè¿‡ ASTï¼ˆæŠ½è±¡è¯­æ³•æ ‘ï¼‰**

```javascript
æºç  â†’ acorn.parse() â†’ AST
â†’ JavascriptParser éå†
â†’ è¯†åˆ« import/require èŠ‚ç‚¹
â†’ åˆ›å»º Dependency å¯¹è±¡
```

**ä½ç½®**ï¼š`lib/javascript/JavascriptParser.js`

---

### é—®é¢˜ 2ï¼šå¦‚ä½•åˆ é™¤æ— ç”¨ä»£ç ï¼Ÿ
**âœ… Tree Shakingï¼ˆSeal é˜¶æ®µä¼˜åŒ–ï¼‰**

```
1. è®°å½•å¯¼å‡ºï¼šexportsInfo.setProvided()
2. æ ‡è®°ä½¿ç”¨ï¼šdependency.getReferencedExports()
3. ç”Ÿæˆæ—¶è·³è¿‡ï¼šif (!exportInfo.used) skip
```

**æ’ä»¶**ï¼š
- `lib/optimize/SideEffectsFlagPlugin.js`
- `lib/optimize/FlagDependencyUsagePlugin.js`

---

### é—®é¢˜ 3ï¼šå¾ªç¯ä¾èµ–æ€ä¹ˆå¤„ç†ï¼Ÿ
**âœ… æ£€æµ‹ + è°ƒæ•´é¡ºåº**

```
æ£€æµ‹ï¼šDFS éå†ï¼Œvisited æ ‡è®°
å¤„ç†ï¼šè°ƒæ•´åŠ è½½é¡ºåºï¼Œä½¿ç”¨å»¶è¿Ÿæ‰§è¡Œ
ç»“æœï¼šè­¦å‘Šä½†ä¸æŠ¥é”™
```

---

### é—®é¢˜ 4ï¼šåŠ¨æ€åŠ è½½åŸç†ï¼Ÿ
**âœ… Make è¯†åˆ« + Seal åˆ›å»ºæ–° Chunk**

```
Makeï¼š
  import() â†’ ImportDependency(async: true)

Sealï¼š
  buildChunkGraph é‡åˆ°å¼‚æ­¥ä¾èµ–
  â†’ åˆ›å»ºæ–° Chunk
  â†’ ç”Ÿæˆ __webpack_require__.e() ä»£ç 
```

---

### é—®é¢˜ 5ï¼šSplitChunksPlugin é…ç½®å®ç°ï¼Ÿ
**âœ… Seal é˜¶æ®µçš„ optimizeChunks é’©å­**

```javascript
// minSize å®ç°
if (calculateSize(modules) < minSize) {
  skip; // ä¸æå–
}

// maxAsyncRequests å®ç°
if (å¼‚æ­¥è¯·æ±‚æ•° > maxAsyncRequests) {
  åªæå–æœ€å¤§çš„å‡ ä¸ªæ¨¡å—;
  å…¶ä½™ä¿ç•™åœ¨åŸ Chunk;
}

// enforce å®ç°
if (enforce === true) {
  å¿½ç•¥æ‰€æœ‰é™åˆ¶;
  å¼ºåˆ¶åˆ›å»º Chunk;
}
```

---

### é—®é¢˜ 6ï¼šChunk name è§„åˆ™ï¼Ÿ
**âœ… å¤šç§æ¥æº**

```
1. å…¥å£ Chunk: entry key
   entry: { app: './app.js' } â†’ 'app'

2. å¼‚æ­¥ Chunk: é­”æ³•æ³¨é‡Šæˆ–æ•°å­—
   import(/* webpackChunkName: "lazy" */ './lazy.js') â†’ 'lazy'
   import('./lazy.js') â†’ 0, 1, 2...

3. å…¬å…± Chunk: cacheGroups.name
   cacheGroups: { vendors: { name: 'vendors' } } â†’ 'vendors'

4. è¿è¡Œæ—¶ Chunk: runtimeChunk.name
   runtimeChunk: { name: 'runtime' } â†’ 'runtime'
```

---

### é—®é¢˜ 7ï¼šBundle å’Œ Chunk è½¬æ¢ï¼Ÿ
**âœ… Seal é˜¶æ®µçš„ createChunkAssets**

```
Chunkï¼ˆå†…å­˜ä¸­çš„æ•°æ®ç»“æ„ï¼‰
  â”œâ”€ id: 'main'
  â”œâ”€ modules: [module1, module2, module3]
  â””â”€ runtime: ...
     â†“
JavascriptModulesPlugin.renderMain()
  â”œâ”€ ç”Ÿæˆè¿è¡Œæ—¶ä»£ç 
  â”œâ”€ åŒ…è£…æ¯ä¸ªæ¨¡å—
  â””â”€ æ‹¼æ¥æˆå®Œæ•´ä»£ç 
     â†“
Source å¯¹è±¡ï¼ˆä»£ç çš„æŠ½è±¡è¡¨ç¤ºï¼‰
  â”œâ”€ source(): è¿”å›ä»£ç å­—ç¬¦ä¸²
  â”œâ”€ size(): è¿”å›å­—èŠ‚å¤§å°
  â””â”€ map(): è¿”å› SourceMap
     â†“
compilation.assets['main.js'] = source
     â†“
Emit é˜¶æ®µå†™å…¥ç£ç›˜
     â†“
dist/main.jsï¼ˆç‰©ç†æ–‡ä»¶ = Bundleï¼‰
```

---

## ğŸ¯ æ ¸å¿ƒæ–¹æ³•è°ƒç”¨é“¾

### Make é˜¶æ®µå®Œæ•´è°ƒç”¨é“¾

```javascript
compiler.hooks.make.callAsync(compilation)
  â†“
EntryPlugin ç›‘å¬å™¨è§¦å‘
  â†“
compilation.addEntry(context, entryDep, options)
  â†“
compilation._addEntryItem()  // å¤„ç†å…¥å£é€‰é¡¹
  â†“
compilation.addModuleTree()  // å¼€å§‹æ„å»ºæ¨¡å—æ ‘
  â†“
compilation.handleModuleCreation()
  â”œâ”€ factorizeModule()  // åˆ›å»ºæ¨¡å—
  â”‚   â”œâ”€ NormalModuleFactory.create()
  â”‚   â”‚   â”œâ”€ resolver.resolve() // è§£æè·¯å¾„
  â”‚   â”‚   â”œâ”€ åŒ¹é… loader
  â”‚   â”‚   â””â”€ new NormalModule()
  â”‚   â””â”€ è¿”å›æ¨¡å—å®ä¾‹
  â”œâ”€ addModule()  // æ·»åŠ åˆ° compilation.modules
  â”œâ”€ buildModule()  // æ„å»ºæ¨¡å— â­â­â­
  â”‚   â”œâ”€ module.build()
  â”‚   â”‚   â”œâ”€ loader-runner æ‰§è¡Œ loader
  â”‚   â”‚   â”œâ”€ parser.parse() è§£æ AST
  â”‚   â”‚   â””â”€ æ”¶é›†ä¾èµ– â†’ module.dependencies
  â”‚   â””â”€ è§¦å‘ succeedModule é’©å­
  â”œâ”€ moduleGraph.setResolvedModule() // å»ºç«‹å›¾è¿æ¥
  â””â”€ processModuleDependencies()  // å¤„ç†ä¾èµ–ï¼ˆé€’å½’ï¼‰
      â†“
      å¯¹æ¯ä¸ªä¾èµ–é€’å½’è°ƒç”¨ handleModuleCreation()
      â†“
      ... ç›´åˆ°æ²¡æœ‰æ–°ä¾èµ–
```

### Seal é˜¶æ®µå®Œæ•´è°ƒç”¨é“¾

```javascript
compilation.seal(callback)
  â”œâ”€ åˆ›å»º ChunkGraph
  â”œâ”€ åˆ›å»ºå…¥å£ Chunk
  â”œâ”€ buildChunkGraph()  // æ„å»º Chunk å›¾ â­â­â­
  â”‚   â”œâ”€ visitModules()  // BFS éå†åˆ†é…æ¨¡å—
  â”‚   â”‚   â”œâ”€ åŒæ­¥ä¾èµ– â†’ connectChunkAndModule(å½“å‰chunk)
  â”‚   â”‚   â””â”€ å¼‚æ­¥ä¾èµ– â†’ åˆ›å»ºæ–° Chunk
  â”‚   â”œâ”€ connectChunkGroups()  // å»ºç«‹çˆ¶å­å…³ç³»
  â”‚   â””â”€ è®¾ç½®è¿è¡Œæ—¶
  â”œâ”€ optimizeModules()  // ä¼˜åŒ–æ¨¡å—ï¼ˆTree Shakingï¼‰
  â”œâ”€ optimizeChunks()  // ä¼˜åŒ– Chunkï¼ˆä»£ç åˆ†å‰²ï¼‰â­â­â­
  â”‚   â””â”€ SplitChunksPlugin
  â”‚       â”œâ”€ åˆ†ææ¨¡å—å…±äº«æƒ…å†µ
  â”‚       â”œâ”€ åº”ç”¨ cacheGroups è§„åˆ™
  â”‚       â”œâ”€ åº”ç”¨ minSizeã€maxAsyncRequests ç­‰é™åˆ¶
  â”‚       â”œâ”€ åˆ›å»ºæ–° Chunk
  â”‚       â””â”€ ç§»åŠ¨æ¨¡å—åˆ°æ–° Chunk
  â”œâ”€ moduleIds()  // ç”Ÿæˆæ¨¡å— ID
  â”œâ”€ chunkIds()  // ç”Ÿæˆ Chunk ID
  â”œâ”€ codeGeneration()  // ç”Ÿæˆä»£ç  â­â­â­
  â”‚   â””â”€ module.codeGeneration() ä¸ºæ¯ä¸ªæ¨¡å—ç”Ÿæˆä»£ç 
  â”œâ”€ processRuntimeRequirements()  // å¤„ç†è¿è¡Œæ—¶éœ€æ±‚
  â”œâ”€ createHash()  // ç”Ÿæˆå“ˆå¸Œ
  â””â”€ createChunkAssets()  // åˆ›å»º Chunk èµ„æº â­â­â­
      â”œâ”€ JavascriptModulesPlugin.renderMain()
      â”‚   â”œâ”€ ç”Ÿæˆè¿è¡Œæ—¶ä»£ç 
      â”‚   â”œâ”€ åŒ…è£…æ¯ä¸ªæ¨¡å—
      â”‚   â””â”€ æ‹¼æ¥æˆå®Œæ•´ä»£ç 
      â””â”€ compilation.assets['main.js'] = source
```

---

## ğŸ† ä½ ç°åœ¨å¯ä»¥ï¼š

### ç†è®ºå±‚é¢
- âœ… è§£é‡Š webpack å®Œæ•´çš„ç¼–è¯‘æµç¨‹
- âœ… è¯´æ˜ Make å’Œ Seal é˜¶æ®µçš„åŒºåˆ«å’Œè”ç³»
- âœ… è§£é‡Šä¾èµ–å›¾å’Œ Chunk å›¾çš„æ•°æ®ç»“æ„
- âœ… è¯´æ˜ Tree Shaking çš„å®ç°åŸç†
- âœ… è§£é‡Šä»£ç åˆ†å‰²çš„å·¥ä½œæœºåˆ¶
- âœ… è¯´æ˜å„ç§é…ç½®é¡¹çš„å®ç°åŸç†

### å®è·µå±‚é¢
- âœ… å¼€å‘è‡ªå®šä¹‰ webpack æ’ä»¶
- âœ… åœ¨åˆé€‚çš„é’©å­æ³¨å†Œé€»è¾‘
- âœ… ä¿®æ”¹æ¨¡å—å’Œ Chunk çš„ç”Ÿæˆè¿‡ç¨‹
- âœ… ä¼˜åŒ– webpack æ„å»ºæ€§èƒ½
- âœ… è°ƒè¯• webpack ç¼–è¯‘é—®é¢˜
- âœ… è´¡çŒ® webpack æºç 

### é¢è¯•å±‚é¢
- âœ… å›ç­” webpack å·¥ä½œåŸç†
- âœ… è§£é‡Š Tree Shaking åŸç†
- âœ… è¯´æ˜ä»£ç åˆ†å‰²æœºåˆ¶
- âœ… è§£é‡Šæ¨¡å—çƒ­æ›¿æ¢ï¼ˆæœ‰åŸºç¡€ï¼‰
- âœ… ä¼˜åŒ–å»ºè®®å’Œæœ€ä½³å®è·µ

---

## ğŸ“š å®Œæ•´èµ„æ–™æ¸…å•

### ğŸ“– å­¦ä¹ æ–‡æ¡£ï¼ˆ10 ä»½ï¼‰
```
å­¦ä¹ æ–‡æ¡£/
â”œâ”€â”€ å¿«é€Ÿå¼€å§‹.md                          â­ 5åˆ†é’Ÿå…¥é—¨
â”œâ”€â”€ 00-æ€»è§ˆä¸è¿›åº¦.md                    â­ è¿›åº¦è¿½è¸ª
â”œâ”€â”€ 01-å·¥ç¨‹åŒ–é…ç½®ä¸å­¦ä¹ è·¯çº¿.md           â­ å­¦ä¹ æŒ‡å—
â”œâ”€â”€ 02-æ ¸å¿ƒä»£ç æ³¨é‡Š-å¯åŠ¨æµç¨‹.md          â­ å¯åŠ¨è¯¦è§£
â”œâ”€â”€ 03-æ‡’åŠ è½½æœºåˆ¶æ·±åº¦è§£æ.md             â­ æ€§èƒ½ä¼˜åŒ–
â”œâ”€â”€ 04-Webpackæ ¸å¿ƒè¿è¡Œæµç¨‹è¯¦è§£.md        â­ å®Œæ•´æµç¨‹
â”œâ”€â”€ 05-ä¾èµ–å›¾æ„å»ºåŸç†è¯¦è§£.md             â­ Make é˜¶æ®µ
â”œâ”€â”€ 06-ä»£ç æ³¨é‡Šè¿›åº¦è¿½è¸ª.md               â­ è¿›åº¦è®°å½•
â”œâ”€â”€ 07-Compileré’©å­ç³»ç»Ÿè¯¦è§£.md           â­ é’©å­ç³»ç»Ÿ
â”œâ”€â”€ 08-æ„å»ºé˜¶æ®µï¼ˆMakeï¼‰.md               â­ Make ç™½è¯è®²è§£
â”œâ”€â”€ 09-å°è£…é˜¶æ®µï¼ˆSealï¼‰.md               â­ Seal ç™½è¯è®²è§£
â””â”€â”€ 10-æ³¨é‡Šå®Œæˆæ€»ç»“.md                   â­ æœ¬æ–‡æ¡£
```

### ğŸ’» å·²æ³¨é‡Šæºç ï¼ˆ12 ä¸ªæ–‡ä»¶ï¼‰
```
å¯åŠ¨æµç¨‹ï¼š
â”œâ”€â”€ bin/webpack.js                       âœ… 100%
â”œâ”€â”€ lib/webpack.js                       âœ… 100%
â””â”€â”€ lib/index.js                         âœ… 60%

ä¾èµ–å›¾ç³»ç»Ÿï¼š
â”œâ”€â”€ lib/Dependency.js                    âœ… 100%
â”œâ”€â”€ lib/ModuleGraph.js                   âœ… 80%
â””â”€â”€ lib/dependencies/
    â””â”€â”€ HarmonyImportDependency.js       âœ… 60%

ç¼–è¯‘å™¨æ ¸å¿ƒï¼š
â”œâ”€â”€ lib/Compiler.js                      âœ… 80%
â””â”€â”€ lib/Compilation.js                   âœ… 60%

Chunk ç³»ç»Ÿï¼š
â”œâ”€â”€ lib/Chunk.js                         âœ… 80%
â”œâ”€â”€ lib/ChunkGraph.js                    âœ… 40%
â””â”€â”€ lib/buildChunkGraph.js               âœ… 60%
```

---

## ğŸŒŸ æœ€ç»ˆæ€»ç»“

### æ•°æ®ç»Ÿè®¡

- **æ–‡æ¡£æ•°é‡**ï¼š10 ä»½
- **æ–‡æ¡£å­—æ•°**ï¼š45000+ å­—
- **æ³¨é‡Šæ–‡ä»¶**ï¼š12 ä¸ªæ ¸å¿ƒæ–‡ä»¶
- **æ³¨é‡Šè¡Œæ•°**ï¼š3000+ è¡Œ
- **è¦†ç›–ç‡**ï¼šæ ¸å¿ƒæµç¨‹ 85%+
- **é—®é¢˜è§£ç­”**ï¼š8 ä¸ªæ ¸å¿ƒé—®é¢˜å…¨éƒ¨è§£ç­”

### æ ¸å¿ƒæˆå°±

**ä½ ç°åœ¨å·²ç»ï¼š**

1. âœ… **å®Œå…¨ç†è§£ webpack çš„ä¸‰å¤§é˜¶æ®µ**
   - åˆå§‹åŒ–ï¼šåˆ›å»º Compilerï¼Œæ³¨å†Œæ’ä»¶
   - Makeï¼šæ„å»ºä¾èµ–å›¾
   - Sealï¼šä¼˜åŒ–å’Œç”Ÿæˆä»£ç 

2. âœ… **æŒæ¡æ ¸å¿ƒæ•°æ®ç»“æ„**
   - ModuleGraphï¼šæ¨¡å—ä¾èµ–å…³ç³»
   - ChunkGraphï¼šChunk åŒ…å«å…³ç³»
   - Dependencyï¼šä¾èµ–æŠ½è±¡

3. âœ… **ç†è§£æ ¸å¿ƒç®—æ³•**
   - ä¾èµ–å›¾æ„å»ºï¼šé€’å½’éå†
   - Chunk å›¾æ„å»ºï¼šBFS åˆ†é…
   - Tree Shakingï¼šå¯¼å‡ºä½¿ç”¨åˆ†æ
   - ä»£ç åˆ†å‰²ï¼šå…±äº«æ¨¡å—æå–

4. âœ… **æŒæ¡å®ç°ç»†èŠ‚**
   - æ‡’åŠ è½½ï¼š50 å€æ€§èƒ½æå‡
   - WeakMapï¼šé¿å…å†…å­˜æ³„æ¼
   - ä½æ“ä½œï¼šå†…å­˜ä¼˜åŒ–
   - é’©å­ç³»ç»Ÿï¼šæ’ä»¶æœºåˆ¶

### å®æˆ˜èƒ½åŠ›

**ä½ ç°åœ¨å¯ä»¥ï¼š**

- âœ… å¼€å‘ webpack æ’ä»¶ï¼ˆçŸ¥é“åœ¨å“ªä¸ªé’©å­åšä»€ä¹ˆï¼‰
- âœ… ä¼˜åŒ–æ„å»ºæ€§èƒ½ï¼ˆçŸ¥é“ç“¶é¢ˆåœ¨å“ªé‡Œï¼‰
- âœ… è§£å†³å¤æ‚é—®é¢˜ï¼ˆç†è§£å†…éƒ¨æœºåˆ¶ï¼‰
- âœ… é˜…è¯» webpack æºç ï¼ˆæœ‰å®Œæ•´çš„æ³¨é‡Šå’Œæ–‡æ¡£ï¼‰
- âœ… å‚ä¸ webpack è´¡çŒ®ï¼ˆç†è§£è®¾è®¡æ€æƒ³ï¼‰

---

## ğŸ é¢å¤–æ”¶è·

### è®¾è®¡æ¨¡å¼
- å·¥å‚æ¨¡å¼ã€è§‚å¯Ÿè€…æ¨¡å¼ã€ç­–ç•¥æ¨¡å¼ã€é—¨é¢æ¨¡å¼

### æ€§èƒ½ä¼˜åŒ–
- æ‡’åŠ è½½ã€è®°å¿†åŒ–ã€å¹¶è¡Œå¤„ç†ã€å¢é‡ç¼–è¯‘

### æ¶æ„æ€æƒ³
- èŒè´£åˆ†ç¦»ã€æ’ä»¶åŒ–ã€é…ç½®é©±åŠ¨ã€æ•°æ®ä¸è¡Œä¸ºåˆ†ç¦»

### JavaScript é«˜çº§æŠ€å·§
- Getter å®ç°æ‡’åŠ è½½ã€WeakMap å†…å­˜ç®¡ç†ã€å‡½æ•°å³å¯¹è±¡

---

## ğŸ‰ æ­å–œä½ ï¼

**ä½ å·²ç»å®Œæˆäº† webpack æºç çš„æ·±åº¦å­¦ä¹ ï¼**

æ‰€æœ‰èµ„æ–™éƒ½åœ¨ `å­¦ä¹ æ–‡æ¡£/` ç›®å½•ä¸‹ï¼Œæ‰€æœ‰æ³¨é‡Šéƒ½åœ¨æºç æ–‡ä»¶ä¸­ã€‚

**ç°åœ¨ä½ å¯ä»¥è‡ªä¿¡åœ°è¯´ï¼šæˆ‘æ‡‚ webpack åŸç†ï¼** ğŸ’ª